org: thr0wn
app: hedgy-cash-oracle
service: hedgy-cash-oracle

provider:
  name: aws
  runtime: nodejs12.x
  stage: ${opt:stage, 'dev'}
  environment:
    MONGO_URL: ${file(./env.${self:provider.stage}.json):MONGO_URL}

plugins:
  - serverless-offline

functions:
  createOracle:
    handler: ./src/oracles/oracles.handler.create
    events:
      - http:
          path: api/rest/oracles
          method: post
          cors: true
  listOracles:
    handler: ./src/oracles/oracles.handler.list
    events:
      - http:
          path: api/rest/oracles
          method: get
          cors: true
  runOracle:
    handler: ./src/oracles/oracles.handler.run
    events:
      - http:
          path: api/rest/oracles/pubKey/{pubKey}/run
          method: get
          cors: true
  findOracleByPubKey:
    handler: ./src/oracles/oracles.handler.findByPubKey
    events:
      - http:
          path: api/rest/oracles/pubKey/{pubKey}
          method: get
          cors: true
  testCode:
    handler: ./src/oracles/oracles.handler.testCode
    events:
      - http:
          path: api/rest/oracles/testCode
          method: post
          cors: true
  publishPrice:
    handler: ./src/oracles/oracles.handler.publishPrice
